---
weight: 1
---

# Design of version1

> 关于下个大版本的设计稿

## 准备工作

- 提升现有的系统稳定性
- 确保系统日志已接入，可回溯问题原因
- 抽象长链接部分，确保后期可替换可测试
- 完善测试流程和测试用例

## 目标

- 支持用户关系，设计用户信息与用户关系
- 完善消息协议
- 支持消息持久化
- 支持 Prometheus 和 open tracing
- **支持写扩散、读扩散**

## 非目标

- admin 能力可以添加但是不重要

## 核心流程

1. 提升稳定性
2. 设计用户相关表设计
3. 设计消息持久化数据结构
4. 添加用户管理相关能力，增删改查用户关系等
5. 完善消息协议，补充必要信息
6. 支持写扩散，读扩散并进行压测

### 提升稳定性

- 添加更完善的测试场景和测试用例，一次全量测试用例跑完后，能确保功能可用的状态。
- 提供一键部署能力，最好是通过 docker-compose 的方式部署各个组件和 Service

### 用户体系

- 用户登录状态
- 用户鉴权
- 用户关系的变更

### 消息持久化

- 通过单独一个组件对所有消息进行持久化到 HBASE
- mq 中的消息信息需要更详细
- 提供查询历史消息的能力

### 用户管理

> optional

- 提供用户管理能力，方便测试 debug

### 消息协议的完善

- 根据进度补充信息

### 读写扩散

- 列出详细的对比、使用场景
- 根据需求实现读写扩散
